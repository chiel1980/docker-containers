# Nginx ironman config

# the upstream component nginx needs to connect to
# HTTP redirect
server {
    listen              80;
    server_name         pragmasec.nl ironman.local.nl.bol.com ironman ironman.pragmasec.nl;
    #rewrite ^/(.*)      https://ironman.local.nl.bol.com/admin/ permanent;
    return         301 https://$server_name$request_uri;
}
# HTTPS server
server {
    # the port your site will be served on
    listen      443;
    # the domain name it will serve for
    server_name pragmasec.nl ironman.local.nl.bol.com ironman.pragmasec.nl; # substitute your machine's IP address or FQDN
#
### Cool SSL ciphers etc
ssl on;
ssl_certificate /etc/ssl/certs/ironman.pragmasec.nl-bundle.crt;
ssl_certificate_key /etc/ssl/private/ironman.pragmasec.nl.key;

ssl_ciphers 'AES128+EECDH:AES128+EDH:!aNULL';

ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
ssl_session_cache shared:SSL:10m;

#ssl_stapling on;
#ssl_stapling_verify on;

ssl_prefer_server_ciphers on;
#ssl_dhparam /etc/ssl/certs/dhparam.pem;

add_header Strict-Transport-Security max-age=63072000;
add_header X-Frame-Options DENY;
add_header X-Content-Type-Options nosniff;

###
#
    charset     utf-8;

    # max upload size
    client_max_body_size 75M;   # adjust to taste

    # Django media
#    location /media  {
#        alias /home/django/ironman/media;  # your Django project's media files - amend as required
#    }

#    location /static {
#        alias /home/django/ironman/static; # your Django project's static files - amend as required
#    }

    # Finally, send all non-media requests to the Django server.

location / {
uwsgi_pass         ironmanapp:3031;
include 	   uwsgi_params;
}
}
